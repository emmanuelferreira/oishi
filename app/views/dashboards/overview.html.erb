
<div class="grid-container">

<h1 class="overview-title">Dashboard</h1>
<br>

<div class="current-order">
  <h3>Previous Order</h3>
    <% @order_products.each do |order_product|%>
      <ul>
        <li>
          <div class="card-product-dashboard">
           <!--  <%= image_tag order_product.product.image %> -->
            <div class="card-product-dashboard-infos">
              <h2><%= order_product.product.name.capitalize %></h2>

              <div class="d-flex justify-content-around badges ">
                <% if order_product.product.eco_score == "A" || order_product.product.eco_score == "B"%>
                  <i class="fas fa-globe-americas fa-2x" style="color: #4CA90C;"></i>
                <%elsif  order_product.product.eco_score == "C" || order_product.product.eco_score == "D"%>
                  <i class="fas fa-globe-americas fa-2x" style="color: #FFC400;"></i>
                <% else %>
                  <i class="fas fa-globe-americas fa-2x" style="color: #EB5757;"></i>
                <% end %>

                <% if order_product.product.nutri_score == "A" || order_product.product.nutri_score == "B"%>
                  <i class="fas fa-heartbeat fa-2x pl-3" style="color: #4CA90C;"></i>
                <%elsif  order_product.product.nutri_score == "C" || order_product.product.nutri_score == "D"%>
                  <i class="fas fa-heartbeat fa-2x pl-3" style="color: #FFC400;"></i>
                <% else %>
                  <i class="fas fa-heartbeat fa-2x pl-3" style="color: #EB5757;"></i>
                <% end %>
                <span><%= order_product.product.price%><%= order_product.product.currency.upcase %></span>
                <!-- <i class="fas fa-money-bill-wave fa-2x pl-3"></i>  money icon removed as we have random prices, add again when we can compare with average price -->
              </div>
            </div>
          </div>
        </li>
      </ul>
    <% end %>
    <span><%= @last_order.total %></span>
  </div>


  <div class="header">
    <h2>Dashboard</h2>
  </div>

  <div class="current-order paper">
    <div class="current-order-infos">
      <h3>Previous Order</h3>
      <ul>
        <li>order_porduct 1 NO PICTURE</li>
      </ul>
    </div>
  </div>

  <div class="eco-chart">
    <div class="eco-chart chart">
      <%= bar_chart @last_order.products.group(:eco_score).count %>
    </div>
  </div>

  <div class="details-chart">
    <div class="nutritionnal-chart chart">
      <%= column_chart(a:3, b:7, c:1, d:6) %>
    </div>
  </div>

  <div class="row justify-content-end top-buffer">
    <div class="col-4">
      <h4>Last Month Consumption Overview</h4>
      <ul>
        <li>Global Ecoscore:  <%= @last_eco_score_avg %></li>
        <li>Global Nutriscore: <%= @last_nutri_score_avg %></li>
        <li>Total Spendings: <%= @last_month_orders.pluck(:total).inject(0) {|sum, ele| sum += ele}.to_f.round(2) %></li>
      </ul>
    </div>
    <div class="col-4">
      <h4>Current Month Consumption Overview</h4>
      <ul>
        <li>Global Ecoscore:  <%= @current_eco_score_avg %></li>
        <li>Global Nutriscore: <%= @current_nutri_score_avg %></li>
        <li>Total Spendings: <%= @current_month_orders.pluck(:total).inject(0) {|sum, ele| sum += ele}.to_f.round(2) %></li>
      </ul>
  </div>

</div>
